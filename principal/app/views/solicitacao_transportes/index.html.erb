<%- model_class = SolicitacaoTransporte -%>
<% content_for :title do %>
<%=  I18n.t('activerecord.models.solicitacao_transporte', default: SolicitacaoTransporte.model_name.human.pluralize.titleize) %>
<% end -%>
<div class="row">
  <div class="col-lg-12">
    <div class="ibox float-e-margins">
      <div class="ibox-title">
        <h5><%=  I18n.t('activerecord.models.solicitacao_transporte', default: SolicitacaoTransporte.model_name.human.pluralize.titleize) %></h5>
        <div class="ibox-tools">
          <a class="collapse-link">
            <i class="fa fa-chevron-up"></i>
          </a>
          <a class="close-link">
            <i class="fa fa-times"></i>
          </a>
        </div>
      </div>
      <div class="ibox-content">
        <div class="row">
          <div class="col-sm-12 b-r">
            <%= render  "manager" %>
            <%= flash[:notice] %>
            <table class="table table-hover table-sm">
              <thead>
                <tr>
                  <th><%= model_class.human_attribute_name(:data_transporte) %></th>
                  <th><%= model_class.human_attribute_name(:data_retorno) %></th>
                  <th><%= model_class.human_attribute_name(:hora_solicitada) %></th>
                  <th><%= model_class.human_attribute_name(:hora_prevista_retorno) %></th>
                  <th><%= model_class.human_attribute_name(:origem) %></th>
                  <th><%= model_class.human_attribute_name(:destino) %></th>
                  <th><%= model_class.human_attribute_name(:tipo_solicitacao_transporte) %></th>
                  <th><%= model_class.human_attribute_name(:area) %></th>
                  <th><%= model_class.human_attribute_name(:destinado_para) %></th>
                  <th><%= model_class.human_attribute_name(:justificativa) %></th>
                  <th><%= model_class.human_attribute_name(:urgente) %></th>
                  <th><%= model_class.human_attribute_name(:justificativa_urgencia) %></th>
                  <th width="18%"><%= I18n.t('helpers.actions') %></th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% @solicitacoes.each do |solicitacao| %>
                  <tr>
                    <td><%= solicitacao.data_transporte %></td>
                    <td><%= solicitacao.data_retorno %></td>
                    <td><%= solicitacao.hora_solicitada&.strftime('%H:%M') %></td>
                    <td><%= solicitacao.hora_prevista_retorno&.strftime('%H:%M') %></td>
                    <td><%= solicitacao.origem %></td>
                    <td><%= solicitacao.destino %></td>
                    <td><%= solicitacao.tipo_solicitacao_transporte %></td>
                    <td><%= solicitacao.area.sigla %></td>
                    <td><%= solicitacao.destinado_para.nome %></td> 
                    <td><%= solicitacao.justificativa %></td>
                    <td><%= boolean_convert(solicitacao.urgente) %></td>
                    <td><%= solicitacao.justificativa_urgencia %></td>
                    <td>
                      <%= link_to_show(solicitacao) %>
                      <%= link_to_edit(edit_solicitacao_transporte_path(solicitacao)) %>
                      <%= link_to_delete(solicitacao) %>
                   </td>
                   <% if current_usuario.pessoa.funcoes.last.nome == "Gestor de transporte" %>
                    <td>   
                      <%= link_to '<i class="fa fa-check"></i> '.html_safe, autorizar_solicitacao_transporte_path(solicitacao.id), class: "btn btn-primary btn-sm" %>
                      <%= link_to '<i class="fa fa-times"></i> '.html_safe, {controller: :solicitacao_transportes, action: :justificar_cancelamento, id: solicitacao.id}, {:remote => true, 'data-toggle' => "modal", 'data-target' => '#modal-window', class: "btn btn-danger btn-sm"} %>
                    </td> 
                   <% end %>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modal-window" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">